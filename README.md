Incident Text-based Classifier → ITSM Console
============================================

Проєкт виріс з прототипу магістерської роботи «Методика автоматизованої
класифікації та пріоритизації інцидентів у сервіс-деск системі із застосуванням
машинного навчання» у невелику ITSM-платформу в дусі GLPI. ML-модель залишилась
незмінною, але навколо неї з’явився повноцінний бекенд з базою даних та
фронтенд-UI для роботи з тікетами, підрозділами, користувачами та активами.

ML-ядро навчається на відкритому датасеті `Tobi-Bueck/customer-support-tickets`
(HuggingFace) і з тексту (title + description) визначає категорію та пріоритет
інциденту. Для україномовних кейсів використовується автоматичний переклад на
англійську.

Стек та структура
-----------------

- **Бекенд:** FastAPI + SQLAlchemy + SQLite (файл `itsm.db`).
- **Основні модулі:**
  - `app/main.py` — точка входу FastAPI, підключення роутерів та ML;
  - `app/models.py` — ORM-моделі (Departments, Users, Assets, Tickets);
  - `app/routers/` — REST-роутери для ML та ITSM-сутностей;
  - `app/ml_client.py` — обгортка над існуючою ML-моделлю пріоритезації.
- **Фронтенд:** single-page React (CDN) у `frontend/index.html`.
- **ML:** артефакти у папці `artifacts/` + вихідні скрипти у `training/`.

Ролі та дозволи
---------------

- **admin** — створює підрозділи та активи, керує ролями користувачів,
  переглядає/редагує всі тікети.
- **agent** — працює з усіма тікетами свого департаменту (або всіма, якщо
  департамент не вказаний), може оновлювати статус/пріоритет.
- **requester** — створює тікети, бачить лише власні.

Запуск
------

```bash
python -m venv .venv
.venv\\Scripts\\activate  # Windows
source .venv/bin/activate   # macOS/Linux
pip install --upgrade pip setuptools wheel
pip install -r requirements.txt

# (опціонально) перевчити моделі
python training/train_hf_tickets.py

# стартувати бекенд
uvicorn app.main:app --reload --port 8000
```

Після старту бекенду документація доступна за `http://127.0.0.1:8000/docs`.
Статичний фронтенд змонтовано на `http://127.0.0.1:8000/ui_llm`.

Основні REST-ендпоінти
----------------------

- `POST /tickets` — створення тікета з автоматичним визначенням пріоритету ML;
- `GET /tickets` — список тікетів з урахуванням ролей;
- `PATCH /tickets/{id}` — оновлення статусу/пріоритету (agent/admin);
- `GET/POST /departments` — робота з підрозділами (create — тільки admin);
- `GET/POST /assets` — реєстрація активів (create — тільки admin);
- `GET/POST /users` — список користувачів, self-registration як requester;
- `PATCH /users/{id}/role` — призначення ролей (admin);
- `POST /users/{id}/assets/{asset_id}` — прив’язка активів до користувача.

Швидкий сценарій
----------------

1. Створіть один департамент та актив через UI в ролі адміністратора.
2. Зареєструйте requester’а за допомогою блоку «Self-registration».
3. Увійдіть як адміністратор (випадаючий список у верхній частині сторінки) та
   призначте requester’у роль і актив (primary).
4. Переключіться на requester’а, створіть тікет — ML автоматично заповнить
   `priority` і `ml_priority`.
5. Переключіться на агента або адміністратора, оновіть статус/пріоритет у
   карточці тікета та простежте зміни у списку.

ML-ендпоінти
------------

Існуючий `/classify_llm` залишився без змін. Він комбінує результати LLM-роутера
та ML-моделі і може використовуватись незалежно від нових ITSM-можливостей.
